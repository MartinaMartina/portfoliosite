(function(b,m,t,u){var e={},l=function(a){this.element=b(a);this.init()};l.prototype={init:function(){b.each(e.demos||{},function(a,b){b.sort(function(a,b){return(a.priority||10)-(b.priority||10)})});this.importButtons=this.element.find(".demo-content .demo-actions button");this.importButtons.on("click.importer",b.proxy(this.onImportButtonClick,this));m.onbeforeunload=b.proxy(function(){if(this.isImporting)return!0},this)},debug:function(a){console.log(a)},feedback:function(a){b(".more-details",this.currentDemoContainer).html(a)},onImportButtonClick:function(a){var c=b(a.target).closest(".demo-content");!this.isImporting&&c.length&&this["import"](c[0]);a.preventDefault()},"import":function(a){var c=this,q=b(a).data("demo-id");if(e.demos&&e.demos.hasOwnProperty(q)){var f=b({}),g=0,n=function(a,b,h){g++;c.debug(b+(h?": "+h:""))},p=function(a){a.success||(g++,c.debug(a.data))};this.currentDemoContainer=a;this.beginImport();b.each(e.demos[q],function(a,b){var h=d.get(b);h.on("notify",c.feedback);h.on("notifyError",c.debug);f.queue(function(a){h.run().done(p).fail(n).then(a,a)})});f.queue(function(a){var b=e.completionMessage.replace("{count}",g.toString());c.feedback.call(c,b);a()});f.queue(b.proxy(this.endImport,this))}},beginImport:function(){this.importButtons.prop("disabled",this.isImporting=!0);b(this.currentDemoContainer).addClass("is-importing")},endImport:function(){var a=this;setTimeout(function(){a.importButtons.prop("disabled",a.isImporting=!1);b(a.currentDemoContainer).removeClass("is-importing");b(a.currentDemoContainer).find(".more-details").empty()},e.importFinishTimeout)}};var d=function(a){this.init(a)};b.extend(d,{get:function(a){return"wordpress"==a.id?new d.WP(a):new d(a)}});d.prototype={init:function(a){this.task=a;this.messages=this.task.messages||{};this.dfd=b.Deferred();delete this.task.messages},ajaxProps:function(a){return{action:e.ajaxAction,_wpnonce:this.task.nonce,demo_id:this.task.demo_id,task_id:this.task.id,task_args:a||this.task.params||{}}},run:function(){this.trigger("notify",this.messages.status||"");b.post(e.ajaxUrl,this.ajaxProps()).done(this.dfd.resolve).fail(this.dfd.reject);return this.dfd.promise()},on:function(a,b){this._events=this._events||{};this._events[a]=this._events[a]||[];this._events[a].push(b)},trigger:function(a){this._events=this._events||{};if(a in this._events)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}};d.extend=function(a){var c=this,e=function(){return c.apply(this,arguments)},f=function(){};f.prototype=c.prototype;e.prototype=new f;b.extend(e.prototype,a);return e};d.WP=d.extend({run:function(){var a=this,c={post_orphans:{},url_remap:{},processed_posts:{}},d=b({}),f=a.task.params||{},g=f.attachments||[],n=0,p=g.length,l=function(e){var d;if(e.success)try{var k=JSON.parse(e.data);b.extend(!0,c,{post_orphans:k.post_orphans,url_remap:k.url_remap,processed_posts:k.processed_posts});k.message&&(d=k.message)}catch(r){d=r.message}else d=e.data;d&&a.trigger("notifyError",d)},m=function(b,e,d){a.trigger("notifyError",e+(d?": "+d:""))};b.each(g,function(c,g){d.queue(function(d){var c,h=a.ajaxProps({"import":"attachment",attachment:g,base_url:f.base_url});c=a.messages.attachmentStatus||"";c=c.replace("{current}",++n);c=c.replace("{total}",p);a.trigger("notify",c);b.post(e.ajaxUrl,h).done(l).fail(m).then(d,d)})});d.queue(function(){a.trigger("notify",a.messages.wpStatus||"");b.post(e.ajaxUrl,a.ajaxProps({"import":"wp",wp:c})).done(a.dfd.resolve).fail(a.dfd.reject)});return a.dfd.promise()}});b(function(){b.extend(e,_youxiImporterSettings);b(".demo-browser").each(function(){new l(this)})})})(jQuery,window,document);